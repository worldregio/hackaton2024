[
  {
    "objectID": "01-Data.html",
    "href": "01-Data.html",
    "title": "Préparation des données",
    "section": "",
    "text": "library(knitr)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(data.table)\n\nWarning: package 'data.table' was built under R version 4.3.3\n\n\n\nAttaching package: 'data.table'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\nlibrary(readr)\nlibrary(sf)\n\nLinking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n\nlibrary(ggplot2)"
  },
  {
    "objectID": "01-Data.html#introduction",
    "href": "01-Data.html#introduction",
    "title": "Préparation des données",
    "section": "Introduction",
    "text": "Introduction"
  },
  {
    "objectID": "01-Data.html#rp-logement-2020-insee",
    "href": "01-Data.html#rp-logement-2020-insee",
    "title": "Préparation des données",
    "section": "RP Logement 2020 (INSEE)",
    "text": "RP Logement 2020 (INSEE)\nNous partons des fichiers détail de l’INSEE car, à la différence des tableaux prédéfinis, ils permettent virtuellement toutes les formes de croisement d’indicateurs. Ils sont évidemment très volumineux mais ici vous avez la chance de bénéficier d’une extraction des communes sur lesquelles vous allez travailler\n\nEtape 1 : Importation des données au format R\nComme les fichiers sont d’assez petite taille, on se contentera d’utiliser la fonctionread.csv qui fait partie du R-base :\n\nt1&lt;-Sys.time()\ntab&lt;-read.csv(\"data/rplogmt_13055.csv\")\nt2&lt;-Sys.time()\npaste (\"chargement effectué en\",t2-t1,\"secondes\")\ndim(tab)\nclass(tab)\n\nDans l’exemple choisi (Marseille) le tableau ne comporte que 182735 individus et se charge en moins d’une seconde\nToutefois, si vous êtes amenés à traiter directement des fichiers de l’INSEE comportant plusieurs millions d’enregistrement vous aurez intérêt à utiliser des fonctions plus puissantes comme la fonction read_csv2 du package readr ou, miuex encore, la fonction fread du package data.table\n\n\nEtape 2 : Sélection des données utiles et sauvegarde au format .RDS\nNos tableaux peuvent être enregistés au format interne de .R ce qui réduira considérablement leur taille par rapport au fichier texte au format .csv qui pèse en général beaucoup plus.\nComme ces données vont nous servir durant tout le projet, elles seront stockées dans le dossier res qui sera spécifique à l’exemple retenu.\n\n## Sauvegarde au format RDS\nsaveRDS(object = tab,\n        file = \"res/tabmen.RDS\")\n\n\nEtape 3 : Chargement et sauvegarde des méta-données\nIl ne faut surtout pas oublier le fichier des métadonnées qui va permettre de recoder facilement tous les facteurs et de décoder les chiffres correspondant aux classes. On va donc le transformer au format R puis l’enregistrer également dans le dossier res. Noter qu’on utilise cette fois-ci la fonction read.csv2car le séparateur de colonne n’est plus la virgule (ce qu’on lit avec read.csv) mais le point virgule.\n\n# Lecture du fichier de métadonnées\nmeta&lt;-read.csv2(\"meta/Dictionnaire variables_logemt_2020.csv\")\n# Enregistrement dans le dossier data\nsaveRDS(object = meta,\n        file = \"res/tabmen_meta.RDS\")"
  },
  {
    "objectID": "01-Data.html#géométries-2020-ign",
    "href": "01-Data.html#géométries-2020-ign",
    "title": "Préparation des données",
    "section": "Géométries 2020 (IGN)",
    "text": "Géométries 2020 (IGN)\nLes contours des unités spatiales correspondant aux codes de l’INSEE sont produits par l’IGN et disponibles sur le site géoservice en accès libre. En général on récupère un très gros fichier pour la France entière ce qui demande un peu de travail pour extraire juste la zone d’étude. Ici vous avez de la chance puisqu’on vous a déjà extrait le fichier relatif à votre commune\n\nEtape 1 : Importation et transformation au format sf\nLa cartographie et plus généralement les opérations géométriques sur des données spatiales dans R peuvent facilement être effectuées avec le package sf (spatial features) qui crée des objets ubniques rassemblant à la fois\n\nun tableau de données (l’équivalent du fichier .dbf)\nune géométrie (l’équivalent du fichier .shp)\nune projection (l’équivalent du fichier .prj)\n\nLorsqu’on récupère des fonds de carte au format shapefile (.shp) ou dans d’autres formats standards comme GeoJson, la première tâche consiste donc à les convertir au formt sf afin de pouvoir les utiliser facilement dans R. L’importation se fait à l’aide de l’instruction st_read en indiquant juste le nom du fichier .shp à charger. Les autres fichiers (.dbf ou .proj) seront lus également et intégrés dans l’objet qui hérite de la double classe data.frame et sf.\n\nlibrary(sf)\nmap_iris &lt;- st_read(\"data/iris_13055.gml\")\n\nReading layer `iris_13055' from data source \n  `/Users/claudegrasland1/worldregio/hackaton2024/data/iris_13055.gml' \n  using driver `GML'\nSimple feature collection with 393 features and 7 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 881250.9 ymin: 6232998 xmax: 905587.3 ymax: 6257715\nProjected CRS: RGF93 Lambert 93\n\ndim(map_iris)\n\n[1] 393   8\n\nclass(map_iris)\n\n[1] \"sf\"         \"data.frame\"\n\nhead(map_iris,2)\n\nSimple feature collection with 2 features and 7 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 892700.6 ymin: 6245602 xmax: 893856.1 ymax: 6246686\nProjected CRS: RGF93 Lambert 93\n        gml_id INSEE_COM                     NOM_COM IRIS CODE_IRIS\n1 iris_13055.0     13206 Marseille 6e Arrondissement  301 132060301\n2 iris_13055.1     13206 Marseille 6e Arrondissement  602 132060602\n        NOM_IRIS TYP_IRIS               geometryProperty\n1        Bergers        H MULTIPOLYGON (((893856.1 62...\n2 Vauban-Fénelon        H MULTIPOLYGON (((892867.6 62...\n\n\nPour faciliter la compatibilité avec d’autres applications, la 8e colonne qui contient le contour des zones est renommée “geometry” plutôt que “geometryProperty”.\n\nst_geometry(map_iris) &lt;-\"geometry\"\n\n\n\nEtape 2 : Visualisation des IRIS de la zone d’étude\nLe nouveau tableau ne comporte plus que 393 unités spatiales et 8 colonnes On peut visualiser rapidement le résultat à l’aide de la fonction plotdu package sf :\n\npar(mar=c(0,0,0,0))\nplot(map_iris$geometry)\n\n\n\n\nOn sauvegarde le résultat dans notre dossier res au format interne de R :\n\nsaveRDS(object = map_iris,\n        file = \"res/map_iris.RDS\")\n\n\n\nEtape 3 : Carte des arrondissements\nComme nous serons amenés à travailler à plusieurs échelles, nous produisons tout de suite un fonds de carte des arrondissements en utilisant les fonctions d’agrégation du packages sf combinées avec celles de dplyr.\n\nmap_arr &lt;- map_iris  %&gt;% group_by(INSEE_COM) %&gt;%\n                        summarise(NOM_COM = min(NOM_COM)) %&gt;%\n                        st_as_sf()\n\non vérifie que l’agrégation s’est bien passée :\n\npar(mar=c(0,0,0,0))\nplot(map_arr$geometry)\n\n\n\n\nEt on sauvegarde le fonds de carte\n\nsaveRDS(object = map_arr,\n        file = \"res/map_arr.RDS\")\n\n\n\nEtape 4 : création d’un contour complet de la commune\nEnfin, on construit un fonds de carte de l’ensemble de la commune étudiée\n\n# Agrégation\nmap_com &lt;- map_iris  %&gt;%     mutate(tot = \"Marseille\") %&gt;%\n                        group_by(tot) %&gt;%\n                        summarise() %&gt;%\n                        st_as_sf()\n# Visualisation\npar(mar=c(0,0,0,0))\nplot(map_com$geometry)\n\n\n\n# Sauvegarde\nsaveRDS(object = map_com,\n        file = \"res/map_com.RDS\")\n\n\n\nEtape 5 : Superposition des trois fonds de carte\nLa fonction plot du package sf permet de superposer des couches cartographiques avec l’instruction add=TRUE. Elle permet également de régler les couleurs des polygones (col=) ainsi que la couleur et l’épaisseur des frontières (border= et lwd=). Lorsqu’on ne souhaite pas remplir les polygones on indique col=NULL.\n\npar(mar=c(0,0,0,0))\nplot(map_iris$geometry, col= \"lightyellow\", border = \"gray80\", lwd=0.5)\nplot(map_arr$geometry, col= NA, border = \"gray50\", lwd=1, add=TRUE)\nplot(map_com$geometry, col= NA, border = \"gray30\", lwd=2, add=TRUE)"
  },
  {
    "objectID": "01-Data.html#logement-social-2020",
    "href": "01-Data.html#logement-social-2020",
    "title": "Préparation des données",
    "section": "Logement social 2020",
    "text": "Logement social 2020\nLes données sur le logement social sont été téléchargées sur le site du ministère du développement durable :\n\nEtape 1 : Chargement du fichier\nOn charge le fichier qui comporte 182735 observation et 70 variables et on le sauvegarde\n\nrpls&lt;-read.csv(\"data/rpls_13055.csv\")\nhead(rpls)\n\n  X.1 DROIT DEPCOM CODEPOSTAL                      LIBCOM NUMVOIE INDREP\n1   1     1  13055      13009 Marseille 9e Arrondissement    &lt;NA&gt;   &lt;NA&gt;\n2   2     1  13055      13009 Marseille 9e Arrondissement    &lt;NA&gt;   &lt;NA&gt;\n3   3     1  13055      13009 Marseille 9e Arrondissement    &lt;NA&gt;   &lt;NA&gt;\n4   4     1  13055      13009 Marseille 9e Arrondissement    &lt;NA&gt;   &lt;NA&gt;\n5   5     1  13055      13009 Marseille 9e Arrondissement    &lt;NA&gt;   &lt;NA&gt;\n6   6     1  13055      13009 Marseille 9e Arrondissement    &lt;NA&gt;   &lt;NA&gt;\n  TYPVOIE                      NOMVOIE NUMAPPT NUMBOITE  ESC COULOIR ETAGE\n1    &lt;NA&gt; 55, Traverse de la Gouffonne     103       NA &lt;NA&gt;    &lt;NA&gt;     0\n2    &lt;NA&gt; 55, Traverse de la Gouffonne     113       NA &lt;NA&gt;    &lt;NA&gt;     1\n3    &lt;NA&gt; 55, Traverse de la Gouffonne     114       NA &lt;NA&gt;    &lt;NA&gt;     1\n4    &lt;NA&gt; 55, Traverse de la Gouffonne     202       NA &lt;NA&gt;    &lt;NA&gt;     0\n5    &lt;NA&gt; 55, Traverse de la Gouffonne     123       NA &lt;NA&gt;    &lt;NA&gt;     2\n6    &lt;NA&gt; 55, Traverse de la Gouffonne     124       NA &lt;NA&gt;    &lt;NA&gt;     2\n  COMPLIDENT ENTREE  BAT     IMMEU                COMPLGEO LIEUDIT QPV\n1       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; 184-BT1-1 RESIDENCE LE MASSALIA I    &lt;NA&gt;   2\n2       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; 184-BT1-1 RESIDENCE LE MASSALIA I    &lt;NA&gt;   2\n3       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; 184-BT1-1 RESIDENCE LE MASSALIA I    &lt;NA&gt;   2\n4       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; 184-BT1-2 RESIDENCE LE MASSALIA I    &lt;NA&gt;   2\n5       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; 184-BT1-1 RESIDENCE LE MASSALIA I    &lt;NA&gt;   2\n6       &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt; 184-BT1-1 RESIDENCE LE MASSALIA I    &lt;NA&gt;   2\n  TYPECONST NBPIECE SURFHAB CONSTRUCT LOCAT PATRIMOINE ORIGINE FINAN FINANAUTRE\n1         C       3      65      1995  1998       1998       1    12         12\n2         C       3      65      1995  1998       1998       1    12         12\n3         C       5     100      1995  1998       1998       1    12         12\n4         C       3      65      1995  1998       1998       1    12         12\n5         C       3      69      1995  1998       1998       1    12         12\n6         C       3      69      1995  1998       1998       1    12         12\n  CONV                    NUMCONV DATCONV NEWLOGT CUS DPEDATE DPEENERGIE\n1    1 13204199785123110750722399      NA      NA  NA      NA          B\n2    1 13204199785123110750722399      NA      NA  NA      NA          B\n3    1 13204199785123110750722399      NA      NA  NA      NA          B\n4    1 13204199785123110750722399      NA      NA  NA      NA          B\n5    1 13204199785123110750722399      NA      NA  NA      NA          B\n6    1 13204199785123110750722399      NA      NA  NA      NA          B\n  DPESERRE SRU_EXPIR SRU_ALINEA CODSEGPATRIM             LIBSEGPATRIM PMR REG\n1        C      2031         NA       SEG001 Marseille Prov. Metropol   1  93\n2        C      2031         NA       SEG001 Marseille Prov. Metropol   1  93\n3        C      2031         NA       SEG001 Marseille Prov. Metropol   1  93\n4        C      2031         NA       SEG001 Marseille Prov. Metropol   1  93\n5        C      2031         NA       SEG001 Marseille Prov. Metropol   1  93\n6        C      2031         NA       SEG001 Marseille Prov. Metropol   1  93\n                      LIBREG DEP           LIBDEP      EPCI\n1 Provence-Alpes-Côte d'Azur  13 Bouches-du-Rhône 200054807\n2 Provence-Alpes-Côte d'Azur  13 Bouches-du-Rhône 200054807\n3 Provence-Alpes-Côte d'Azur  13 Bouches-du-Rhône 200054807\n4 Provence-Alpes-Côte d'Azur  13 Bouches-du-Rhône 200054807\n5 Provence-Alpes-Côte d'Azur  13 Bouches-du-Rhône 200054807\n6 Provence-Alpes-Côte d'Azur  13 Bouches-du-Rhône 200054807\n                             LIBEPCI EPSG        X       Y PLG_QP PLG_IRIS2021\n1 Métropole d'Aix-Marseille-Provence 2154 895698.9 6241946     HZ          404\n2 Métropole d'Aix-Marseille-Provence 2154 895698.9 6241946     HZ          404\n3 Métropole d'Aix-Marseille-Provence 2154 895698.9 6241946     HZ          404\n4 Métropole d'Aix-Marseille-Provence 2154 895698.9 6241946     HZ          404\n5 Métropole d'Aix-Marseille-Provence 2154 895698.9 6241946     HZ          404\n6 Métropole d'Aix-Marseille-Provence 2154 895698.9 6241946     HZ          404\n  PLG_ZUS PLG_ZFU PLG_QVA PLG_CODE_COMMUNE2021 QUALITE_VOIE QUALITE_NUMERO\n1      HZ     CSZ      HZ                13209           NA             NA\n2      HZ     CSZ      HZ                13209           NA             NA\n3      HZ     CSZ      HZ                13209           NA             NA\n4      HZ     CSZ      HZ                13209           NA             NA\n5      HZ     CSZ      HZ                13209           NA             NA\n6      HZ     CSZ      HZ                13209           NA             NA\n  QUALITE_XY DISTANCE_PRECISION QUALITE_QP QUALITE_IRIS QUALITE_ZUS QUALITE_ZFU\n1         11               &lt;NA&gt;          1            1           1          NA\n2         11               &lt;NA&gt;          1            1           1          NA\n3         11               &lt;NA&gt;          1            1           1          NA\n4         11               &lt;NA&gt;          1            1           1          NA\n5         11               &lt;NA&gt;          1            1           1          NA\n6         11               &lt;NA&gt;          1            1           1          NA\n  QUALITE_QVA COMAQP COMRIL\n1           1      1      1\n2           1      1      1\n3           1      1      1\n4           1      1      1\n5           1      1      1\n6           1      1      1\n\nsaveRDS(rpls,\"res/rpls.RDS\")\n\n\n\nEtape 2 : Test de superposition géométrique\nLe fichier comporte deux colonnes X et Y dont on ignore la projection. On va tester leur superposition sur les fonds de carte précédents pour voir s’il s’agit de la même.\n\npar(mar=c(0,0,0,0))\nplot(map_iris$geometry, col= \"lightyellow\", border = \"gray80\", lwd=0.5)\nplot(map_arr$geometry, col= NA, border = \"gray50\", lwd=1, add=TRUE)\nplot(map_com$geometry, col= NA, border = \"gray30\", lwd=2, add=TRUE)\npoints(rpls$X, rpls$Y, col=\"red\",pch=20, cex=0.2)\n\n\n\n\nBingo, la superposition est parfaite donc la projection est la même. Il s’agit de la Lambert93 dont le CRS peut-être affiché par la commande st_crs() du package sf :\n\nst_crs(map_iris)\n\nCoordinate Reference System:\n  User input: RGF93 Lambert 93 \n  wkt:\nPROJCRS[\"RGF93 Lambert 93\",\n    BASEGEOGCRS[\"RGF93 geographiques (dms)\",\n        DATUM[\"Reseau Geodesique Francais 1993 v1\",\n            ELLIPSOID[\"GRS 1980\",6378137,298.257222101,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"IGNF\",\"RGF93G\"]],\n    CONVERSION[\"LAMBERT-93\",\n        METHOD[\"Lambert Conic Conformal (2SP)\",\n            ID[\"EPSG\",9802]],\n        PARAMETER[\"Latitude of false origin\",46.5,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8821]],\n        PARAMETER[\"Longitude of false origin\",3,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8822]],\n        PARAMETER[\"Latitude of 1st standard parallel\",44,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8823]],\n        PARAMETER[\"Latitude of 2nd standard parallel\",49,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8824]],\n        PARAMETER[\"Easting at false origin\",700000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8826]],\n        PARAMETER[\"Northing at false origin\",6600000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8827]]],\n    CS[Cartesian,2],\n        AXIS[\"easting (X)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"northing (Y)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"NATIONALE A CARACTERE LEGAL\"],\n        AREA[\"FRANCE METROPOLITAINE (CORSE COMPRISE)\"],\n        BBOX[41,-5.5,52,10]],\n    ID[\"IGNF\",\"LAMB93\"]]\n\n\n\n\nEtape 3 : Carte des logements sociaux\nOn va alors pouvoir créer un fonds de carte géométrique de ces logements sociaux en indiquant la projection du fonds de carte des Iris.\n\n# Transformation du data.frame en objet sf\nrpls_geom&lt;-st_as_sf(rpls,coords = c(\"X\",\"Y\"))\n\n# Récupération du code EPSG de la projection\nst_crs(rpls_geom)&lt;-st_crs(map_iris)\n\n# Sauvegarde au format .RDS\nsaveRDS(rpls_geom, \"res/rpls_geom.RDS\")"
  },
  {
    "objectID": "01-Data.html#bilan",
    "href": "01-Data.html#bilan",
    "title": "Préparation des données",
    "section": "Bilan",
    "text": "Bilan\nNous avons désormais un dossier res qui comporte tous les éléments utiles pour l’analyse de notre zone d’étude.\n\nLe recensement des logements ordinaires en 2020 et ses métadonnées\nLes fonds de carte par iris, arrondissement et commune.\nLe fichier du RPLS pour l’année 2020 en version statistique ou cartographique\n\n\nlist.files(\"res\")\n\n[1] \"map_arr.RDS\"     \"map_com.RDS\"     \"map_iris.RDS\"    \"rpls_geom.RDS\"  \n[5] \"rpls.RDS\"        \"tabmen_meta.RDS\" \"tabmen.RDS\""
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Hackaton 2024",
    "section": "",
    "text": "Développer vos connaissances en analyse quantitative des données dans l’espace\nExploiter des données individuelles (recensement de la population, répertoire logements sociaux)\nApprofondir votre utilisation du logiciel R\nTravailler en groupe et préparer une restitution commune\nRépondre à une “commande” dans un temps limité"
  },
  {
    "objectID": "index.html#objectifs-de-la-semaine",
    "href": "index.html#objectifs-de-la-semaine",
    "title": "Hackaton 2024",
    "section": "",
    "text": "Développer vos connaissances en analyse quantitative des données dans l’espace\nExploiter des données individuelles (recensement de la population, répertoire logements sociaux)\nApprofondir votre utilisation du logiciel R\nTravailler en groupe et préparer une restitution commune\nRépondre à une “commande” dans un temps limité"
  }
]